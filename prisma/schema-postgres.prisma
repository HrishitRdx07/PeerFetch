// This is a list of providers whose functionality depends on a filesystem
// For production use with Vercel, you MUST use PostgreSQL
// 
// 1. Go to Vercel Dashboard -> Storage -> Create Database -> Postgres
// 2. Copy the DATABASE_URL from environment variables  
// 3. Add it to your .env file locally and in Vercel settings
//
// Example .env:
// DATABASE_URL="postgresql://user:password@host/database?sslmode=require"

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"  // Changed from "sqlite"
  url      = env("DATABASE_URL")
}

// ... rest of your models stay the same
model User {
  id            String   @id @default(cuid())
  studentId     String   @unique
  password      String
  name          String
  email         String?
  branch        String
  year          Int
  batch         Int
  isAdmin       Boolean  @default(false)
  isApproved    Boolean  @default(false)
  profilePicture String?
  bio           String?
  skills        String?
  extracurriculars String?
  linkedinUrl   String?
  
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
  
  sentRequests     MentorshipRequest[] @relation("MentorRequests")
  receivedRequests MentorshipRequest[] @relation("MenteeRequests")
  
  sentConnections     Connection[] @relation("SentConnections")
  receivedConnections Connection[] @relation("ReceivedConnections")
  
  sentMessages     Message[] @relation("SentMessages")
  receivedMessages Message[] @relation("ReceivedMessages")
  
  sessions Session[]
}

model MentorshipRequest {
  id        String   @id @default(cuid())
  mentorId  String
  menteeId  String
  message   String
  status    String   @default("pending")
  
  mentor    User     @relation("MentorRequests", fields: [mentorId], references: [id])
  mentee    User     @relation("MenteeRequests", fields: [menteeId], references: [id])
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Connection {
  id         String   @id @default(cuid())
  senderId   String
  receiverId String
  status     String   @default("pending")
  
  sender     User     @relation("SentConnections", fields: [senderId], references: [id])
  receiver   User     @relation("ReceivedConnections", fields: [receiverId], references: [id])
  
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
  
  @@unique([senderId, receiverId])
}

model Message {
  id         String   @id @default(cuid())
  senderId   String
  receiverId String
  content    String
  isRead     Boolean  @default(false)
  
  sender     User     @relation("SentMessages", fields: [senderId], references: [id])
  receiver   User     @relation("ReceivedMessages", fields: [receiverId], references: [id])
  
  createdAt  DateTime @default(now())
}

model Session {
  id        String   @id @default(cuid())
  token     String   @unique
  userId    String
  expiresAt DateTime
  
  user      User     @relation(fields: [userId], references: [id])
  
  createdAt DateTime @default(now())
}
